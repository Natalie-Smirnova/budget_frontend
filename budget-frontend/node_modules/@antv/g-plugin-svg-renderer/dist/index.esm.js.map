{"version":3,"file":"index.esm.js","sources":["../src/components/ElementSVG.ts","../src/shapes/paths/Image.ts","../src/shapes/paths/Line.ts","../src/shapes/paths/Path.ts","../src/shapes/paths/Polyline.ts","../src/shapes/paths/Rect.ts","../src/utils/dom.ts","../src/shapes/defs/Filter.ts","../src/shapes/defs/Pattern.ts","../src/shapes/defs/Shadow.ts","../src/shapes/defs/DefElementManager.ts","../src/utils/format.ts","../src/SVGRendererPlugin.ts","../src/shapes/paths/Text.ts","../src/DefaultElementLifeCycleContribution.ts","../src/index.ts"],"sourcesContent":["export class ElementSVG {\n  static tag = 'c-svg-element';\n\n  /**\n   * basic element, eg. <circle>|<ellipse>\n   */\n  $el: SVGElement | null;\n\n  /**\n   * group wrapper for basic element, eg. <g><circle /></g>.\n   * if current element is <g>, same as `$el`\n   */\n  $groupEl: SVGElement | null;\n\n  /**\n   * hitArea:\n   * $groupEl -> $el\n   *          -> $hitTestingEl\n   */\n  $hitTestingEl: SVGElement | null;\n}\n","import type { ParsedImageStyleProps } from '@antv/g-lite';\nimport { isString } from '@antv/util';\n\nexport function updateImageElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedImageStyleProps,\n) {\n  const { src = '', x = 0, y = 0, width, height } = parsedStyle;\n\n  $el.setAttribute('x', `${x}`);\n  $el.setAttribute('y', `${y}`);\n\n  if (isString(src)) {\n    $el.setAttribute('href', src);\n  } else if (src instanceof Image) {\n    if (!width) {\n      $el.setAttribute('width', `${src.width}`);\n    }\n    if (!height) {\n      $el.setAttribute('height', `${src.height}`);\n    }\n    $el.setAttribute('href', src.src);\n  } else if (\n    // @ts-ignore\n    src instanceof HTMLElement &&\n    isString((src as HTMLElement).nodeName) &&\n    (src as HTMLElement).nodeName.toUpperCase() === 'CANVAS'\n  ) {\n    $el.setAttribute('href', (src as HTMLCanvasElement).toDataURL());\n    // @ts-ignore\n  } else if (src instanceof ImageData) {\n    const canvas = document.createElement('canvas');\n    // @ts-ignore\n    canvas.setAttribute('width', `${src.width}`);\n    // @ts-ignore\n    canvas.setAttribute('height', `${src.height}`);\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.putImageData(src, 0, 0);\n      if (!width) {\n        // @ts-ignore\n        $el.setAttribute('width', `${src.width}`);\n      }\n      if (!height) {\n        // @ts-ignore\n        $el.setAttribute('height', `${src.height}`);\n      }\n      $el.setAttribute('href', canvas.toDataURL());\n    }\n  }\n}\n","import type { ParsedLineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function updateLineElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedLineStyleProps,\n) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    markerStart,\n    markerEnd,\n    markerStartOffset,\n    markerEndOffset,\n  } = parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = x2 - x1;\n    y = y2 - y1;\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = x1 - x2;\n    y = y1 - y2;\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  // @see https://github.com/antvis/g/issues/1038\n  $el.setAttribute('x1', `${x1 + startOffsetX}`);\n  $el.setAttribute('y1', `${y1 + startOffsetY}`);\n  $el.setAttribute('x2', `${x2 + endOffsetX}`);\n  $el.setAttribute('y2', `${y2 + endOffsetY}`);\n}\n","import type { ParsedPathStyleProps, Path } from '@antv/g-lite';\nimport { isDisplayObject, translatePathToString } from '@antv/g-lite';\n\nexport function updatePathElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedPathStyleProps,\n) {\n  const { d, markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    const [p1, p2] = (markerStart.parentNode as Path).getStartTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    const [p1, p2] = (markerEnd.parentNode as Path).getEndTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  $el.setAttribute(\n    'd',\n    translatePathToString(\n      d.absolutePath,\n      startOffsetX,\n      startOffsetY,\n      endOffsetX,\n      endOffsetY,\n    ),\n  );\n}\n","import type { ParsedPolylineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function updatePolylineElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedPolylineStyleProps,\n) {\n  const {\n    points: { points },\n    markerStart,\n    markerStartOffset,\n    markerEnd,\n    markerEndOffset,\n  } = parsedStyle;\n  const { length } = points;\n\n  if (points && length >= 2) {\n    let startOffsetX = 0;\n    let startOffsetY = 0;\n    let endOffsetX = 0;\n    let endOffsetY = 0;\n\n    let rad = 0;\n    let x: number;\n    let y: number;\n\n    if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n      x = points[1][0] - points[0][0];\n      y = points[1][1] - points[0][1];\n      rad = Math.atan2(y, x);\n      startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n      startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n    }\n\n    if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n      x = points[length - 2][0] - points[length - 1][0];\n      y = points[length - 2][1] - points[length - 1][1];\n      rad = Math.atan2(y, x);\n      endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n      endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n    }\n\n    $el.setAttribute(\n      'points',\n      points\n        .map((point: [number, number], i) => {\n          let offsetX = 0;\n          let offsetY = 0;\n          if (i === 0) {\n            offsetX = startOffsetX;\n            offsetY = startOffsetY;\n          } else if (i === length - 1) {\n            offsetX = endOffsetX;\n            offsetY = endOffsetY;\n          }\n          return `${point[0] + offsetX},${point[1] + offsetY}`;\n        })\n        .join(' '),\n    );\n  }\n}\n","import type { ParsedRectStyleProps } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\n\nexport function updateRectElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedRectStyleProps,\n) {\n  const { radius, x = 0, y = 0, width, height } = parsedStyle;\n\n  // CSSKeyword: auto\n  if (!isFinite(width) || !isFinite(height)) {\n    return;\n  }\n\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  let d = '';\n  if (!hasRadius) {\n    d = `M ${x},${y} l ${width},0 l 0,${height} l${-width} 0 z`;\n  } else {\n    const [tlr, trr, brr, blr] = radius.map((r) =>\n      clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2)),\n    );\n\n    const signX = width > 0 ? 1 : -1;\n    const signY = height > 0 ? 1 : -1;\n    // sweep-flag @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths#arcs\n    const sweepFlag = signX + signY !== 0 ? 1 : 0;\n    d = [\n      [`M ${signX * tlr + x},${y}`],\n      [`l ${width - signX * (tlr + trr)},0`],\n      [`a ${trr},${trr},0,0,${sweepFlag},${signX * trr},${signY * trr}`],\n      [`l 0,${height - signY * (trr + brr)}`],\n      [`a ${brr},${brr},0,0,${sweepFlag},${-signX * brr},${signY * brr}`],\n      [`l ${signX * (brr + blr) - width},0`],\n      [`a ${blr},${blr},0,0,${sweepFlag},${-signX * blr},${-signY * blr}`],\n      [`l 0,${signY * (blr + tlr) - height}`],\n      [`a ${tlr},${tlr},0,0,${sweepFlag},${signX * tlr},${-signY * tlr}`],\n      ['z'],\n    ].join(' ');\n  }\n  $el.setAttribute('d', d);\n}\n","export function createSVGElement(type: string, doc?: Document): SVGElement {\n  return (doc || document).createElementNS('http://www.w3.org/2000/svg', type);\n}\n","import type {\n  CSSUnitValue,\n  DisplayObject,\n  ParsedBaseStyleProps,\n} from '@antv/g-lite';\nimport { UnitType } from '@antv/g-lite';\nimport { createSVGElement } from '../../utils/dom';\n\nexport const FILTER_PREFIX = 'g-filter-';\n\n/**\n * use SVG filters, eg. blur, brightness, contrast...\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nexport function createOrUpdateFilter(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  filters: ParsedBaseStyleProps['filter'],\n) {\n  // eg. filter=\"url(#f1) url(#f2)\"\n  const filterName = FILTER_PREFIX + object.entity;\n\n  const $existedFilters = $def.querySelectorAll(`[name=${filterName}]`);\n  if ($existedFilters.length) {\n    $existedFilters.forEach(($filter) => {\n      $def.removeChild($filter);\n    });\n  }\n\n  if (filters.length === 0) {\n    // 'none'\n    $el?.removeAttribute('filter');\n  } else {\n    const filterIds = filters.map(({ name, params }, i) => {\n      const $filter = createSVGElement('filter', document) as SVGFilterElement;\n      // @see https://github.com/antvis/g/issues/1025\n      $filter.setAttribute('filterUnits', 'userSpaceOnUse');\n      if (name === 'blur') {\n        createBlur(document, $filter, params);\n      } else if (name === 'brightness') {\n        createBrightness(document, $filter, params);\n      } else if (name === 'drop-shadow') {\n        createDropShadow(document, $filter, params);\n      } else if (name === 'contrast') {\n        createContrast(document, $filter, params);\n      } else if (name === 'grayscale') {\n        createGrayscale(document, $filter, params);\n      } else if (name === 'sepia') {\n        createSepia(document, $filter, params);\n      } else if (name === 'saturate') {\n        createSaturate(document, $filter, params);\n      } else if (name === 'hue-rotate') {\n        createHueRotate(document, $filter, params);\n      } else if (name === 'invert') {\n        createInvert(document, $filter, params);\n      }\n\n      $filter.id = `${filterName}-${i}`;\n      $filter.setAttribute('name', filterName);\n      $def.appendChild($filter);\n\n      return $filter.id;\n    });\n\n    // @see https://github.com/antvis/G/issues/1114\n    setTimeout(() => {\n      $el?.setAttribute(\n        'filter',\n        filterIds.map((filterId) => `url(#${filterId})`).join(' '),\n      );\n    });\n  }\n}\n\nfunction convertToAbsoluteValue(param: CSSUnitValue) {\n  return param.unit === UnitType.kPercentage ? param.value / 100 : param.value;\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#blurEquivalent\n */\nfunction createBlur(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n  $feGaussianBlur.setAttribute('in', 'SourceGraphic');\n  $feGaussianBlur.setAttribute('stdDeviation', `${params[0].value}`);\n  $filter.appendChild($feGaussianBlur);\n}\n\nfunction createFeComponentTransfer(\n  document: Document,\n  $filter: SVGElement,\n  {\n    type,\n    slope,\n    intercept,\n    tableValues,\n  }: {\n    type: string;\n    slope?: number;\n    intercept?: number;\n    tableValues?: string;\n  },\n) {\n  const $feComponentTransfer = createSVGElement(\n    'feComponentTransfer',\n    document,\n  );\n  [\n    createSVGElement('feFuncR', document),\n    createSVGElement('feFuncG', document),\n    createSVGElement('feFuncB', document),\n  ].forEach(($feFunc) => {\n    $feFunc.setAttribute('type', type);\n\n    if (type === 'table') {\n      $feFunc.setAttribute('tableValues', `${tableValues}`);\n    } else {\n      $feFunc.setAttribute('slope', `${slope}`);\n      $feFunc.setAttribute('intercept', `${intercept}`);\n    }\n\n    $feComponentTransfer.appendChild($feFunc);\n  });\n\n  $filter.appendChild($feComponentTransfer);\n}\n\nfunction createContrast(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const slope = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'linear',\n    slope,\n    intercept: -(0.5 * slope) + 0.5,\n  });\n}\n\nfunction createInvert(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'table',\n    tableValues: `${amount} ${1 - amount}`,\n  });\n}\n\nfunction createBrightness(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const slope = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'linear',\n    slope,\n    intercept: 0,\n  });\n}\n\nfunction createSaturate(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'saturate');\n  $feColorMatrix.setAttribute('values', `${amount}`);\n  $filter.appendChild($feColorMatrix);\n}\n\nfunction createHueRotate(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'hueRotate');\n  // $feColorMatrix.setAttribute('values', `${params[0].to(UnitType.kDegrees).value}`);\n  // FIXME: convert to degrees\n  $feColorMatrix.setAttribute('values', `${params[0].value}`);\n  $filter.appendChild($feColorMatrix);\n}\n\nfunction createDropShadow(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const shadowOffsetX = params[0].value;\n  const shadowOffsetY = params[1].value;\n  const shadowBlur = params[2].value;\n  // @ts-ignore\n  const shadowColor = params[3].formatted as string;\n  const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n  $feGaussianBlur.setAttribute('in', 'SourceAlpha');\n  $feGaussianBlur.setAttribute('stdDeviation', `${shadowBlur}`);\n  $filter.appendChild($feGaussianBlur);\n\n  const $feOffset = createSVGElement('feOffset', document);\n  $feOffset.setAttribute('dx', `${shadowOffsetX}`);\n  $feOffset.setAttribute('dy', `${shadowOffsetY}`);\n  $feOffset.setAttribute('result', 'offsetblur');\n  $filter.appendChild($feOffset);\n\n  const $feFlood = createSVGElement('feFlood', document);\n  $feFlood.setAttribute('flood-color', shadowColor);\n  $filter.appendChild($feFlood);\n\n  const $feComposite = createSVGElement('feComposite', document);\n  $feComposite.setAttribute('in2', 'offsetblur');\n  $feComposite.setAttribute('operator', 'in');\n  $filter.appendChild($feComposite);\n\n  const $feMerge = createSVGElement('feMerge', document);\n  $filter.appendChild($feMerge);\n\n  const $feMergeNode1 = createSVGElement('feMergeNode', document);\n  const $feMergeNode2 = createSVGElement('feMergeNode', document);\n  $feMergeNode2.setAttribute('in', 'SourceGraphic');\n  $feMerge.appendChild($feMergeNode1);\n  $feMerge.appendChild($feMergeNode2);\n}\n\nfunction createFeColorMatrix(\n  document: Document,\n  $filter: SVGElement,\n  matrix: number[],\n) {\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'matrix');\n  $feColorMatrix.setAttribute('values', matrix.join(' '));\n  $filter.appendChild($feColorMatrix);\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#grayscaleEquivalent\n */\nfunction createGrayscale(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeColorMatrix(document, $filter, [\n    0.2126 + 0.7874 * (1 - amount),\n    0.7152 - 0.7152 * (1 - amount),\n    0.0722 - 0.0722 * (1 - amount),\n    0,\n    0,\n    0.2126 - 0.2126 * (1 - amount),\n    0.7152 + 0.2848 * (1 - amount),\n    0.0722 - 0.0722 * (1 - amount),\n    0,\n    0,\n    0.2126 - 0.2126 * (1 - amount),\n    0.7152 - 0.7152 * (1 - amount),\n    0.0722 + 0.9278 * (1 - amount),\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ]);\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#sepiaEquivalent\n */\nfunction createSepia(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeColorMatrix(document, $filter, [\n    0.393 + 0.607 * (1 - amount),\n    0.769 - 0.769 * (1 - amount),\n    0.189 - 0.189 * (1 - amount),\n    0,\n    0,\n    0.349 - 0.349 * (1 - amount),\n    0.686 + 0.314 * (1 - amount),\n    0.168 - 0.168 * (1 - amount),\n    0,\n    0,\n    0.272 - 0.272 * (1 - amount),\n    0.534 - 0.534 * (1 - amount),\n    0.131 + 0.869 * (1 - amount),\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ]);\n}\n","import type { CSSRGB, Pattern, RadialGradient } from '@antv/g-lite';\nimport {\n  DisplayObject,\n  LinearGradient,\n  parseTransform,\n  computeLinearGradient,\n  computeRadialGradient,\n  CSSGradientValue,\n  GradientType,\n  Rect,\n  isBrowser,\n  isPattern,\n  isCSSRGB,\n  isCSSGradientValue,\n} from '@antv/g-lite';\nimport { isString } from '@antv/util';\nimport { SVGRendererPlugin } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { FILTER_PREFIX } from './Filter';\n\nexport const PATTERN_PREFIX = 'g-pattern-';\nlet cacheKey2IDMap: Record<string, string> = {};\nlet counter = 0;\n\nexport function resetPatternCounter() {\n  counter = 0;\n  cacheKey2IDMap = {};\n}\n\nexport function createOrUpdateGradientAndPattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  parsedColor: CSSGradientValue[] | CSSRGB | Pattern,\n  name: string,\n  createImage: (url: string) => HTMLImageElement,\n  plugin: SVGRendererPlugin,\n) {\n  // eg. clipPath don't have fill/stroke\n  if (!parsedColor) {\n    return '';\n  }\n\n  if (isCSSRGB(parsedColor)) {\n    // keep using currentColor @see https://github.com/d3/d3-axis/issues/49\n    if (object.style[name] === 'currentColor') {\n      $el?.setAttribute(name, 'currentColor');\n    } else {\n      // constant value, eg. '#fff'\n      $el?.setAttribute(\n        name,\n        parsedColor.isNone ? 'none' : parsedColor.toString(),\n      );\n    }\n  } else if (isPattern(parsedColor)) {\n    const patternId = createOrUpdatePattern(\n      document,\n      $def,\n      object,\n      parsedColor,\n      createImage,\n      plugin,\n    );\n    // use style instead of attribute when applying <pattern>\n    // @see https://stackoverflow.com/a/7723115\n    $el.style[name] = `url(#${patternId})`;\n    return patternId;\n  } else {\n    if (parsedColor.length === 1) {\n      const gradientId = createOrUpdateGradient(\n        document,\n        object,\n        $def,\n        $el,\n        parsedColor[0],\n      );\n      $el?.setAttribute(name, `url(#${gradientId})`);\n      return gradientId;\n    }\n    // @see https://stackoverflow.com/questions/20671502/can-i-blend-gradients-in-svg\n    const filterId = createOrUpdateMultiGradient(\n      document,\n      object,\n      $def,\n      $el,\n      parsedColor,\n    );\n    $el?.setAttribute('filter', `url(#${filterId})`);\n    $el?.setAttribute('fill', 'black');\n    return filterId;\n  }\n\n  return '';\n}\n\nfunction generateCacheKey(\n  src: CSSGradientValue | CSSRGB | Pattern,\n  options: any = {},\n): string {\n  let cacheKey = '';\n  if (isCSSGradientValue(src)) {\n    const { type, value } = src;\n    if (\n      type === GradientType.LinearGradient ||\n      type === GradientType.RadialGradient\n    ) {\n      // @ts-ignore\n      const { type, x, y, width, height, steps, angle, cx, cy, size } = {\n        ...value,\n        ...options,\n      };\n      cacheKey = `gradient-${type}-${x?.toString() || 0}-${\n        y?.toString() || 0\n      }-${angle?.toString() || 0}-${cx?.toString() || 0}-${\n        cy?.toString() || 0\n      }-${size?.toString() || 0}-${width}-${height}-${steps\n        .map(({ offset, color }) => `${offset}${color}`)\n        .join('-')}`;\n    }\n  } else if (isPattern(src)) {\n    if (isString(src.image)) {\n      cacheKey = `pattern-${src.image}-${src.repetition}`;\n    } else if ((src.image as Rect).nodeName === 'rect') {\n      // use rect's entity as key\n      cacheKey = `pattern-rect-${(src.image as Rect).entity}`;\n    } else {\n      cacheKey = `pattern-${counter}`;\n    }\n  }\n\n  if (cacheKey) {\n    if (!cacheKey2IDMap[cacheKey]) {\n      cacheKey2IDMap[cacheKey] = `${PATTERN_PREFIX}${counter++}`;\n    }\n  }\n\n  return cacheKey2IDMap[cacheKey];\n}\n\nfunction formatTransform(transform: string) {\n  // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/patternTransform\n  // should remove unit: rotate(20deg) -> rotate(20)\n  return parseTransform(transform)\n    .map((parsed) => {\n      const { t, d } = parsed;\n      if (t === 'translate') {\n        return `translate(${d[0].value} ${d[1].value})`;\n      }\n      if (t === 'translateX') {\n        return `translate(${d[0].value} 0)`;\n      }\n      if (t === 'translateY') {\n        return `translate(0 ${d[0].value})`;\n      }\n      if (t === 'rotate') {\n        return `rotate(${d[0].value})`;\n      }\n      if (t === 'scale') {\n        // scale(1) scale(1, 1)\n        const newScale = d?.map((s) => s.value) || [1, 1];\n        return `scale(${newScale[0]}, ${newScale[1]})`;\n      }\n      if (t === 'scaleX') {\n        const newScale = d?.map((s) => s.value) || [1];\n        return `scale(${newScale[0]}, 1)`;\n      }\n      if (t === 'scaleY') {\n        const newScale = d?.map((s) => s.value) || [1];\n        return `scale(1, ${newScale[0]})`;\n      }\n      if (t === 'skew') {\n        const newSkew = d?.map((s) => s.value) || [0, 0];\n        return `skewX(${newSkew[0]}) skewY(${newSkew[1]})`;\n      }\n      if (t === 'skewZ') {\n        const newSkew = d?.map((s) => s.value) || [0];\n        return `skewX(${newSkew[0]})`;\n      }\n      if (t === 'skewY') {\n        const newSkew = d?.map((s) => s.value) || [0];\n        return `skewY(${newSkew[0]})`;\n      }\n      if (t === 'matrix') {\n        const [a, b, c, dd, tx, ty] = d.map((s) => s.value);\n        return `matrix(${a} ${b} ${c} ${dd} ${tx} ${ty})`;\n      }\n\n      return null;\n    })\n    .filter((item) => item !== null)\n    .join(' ');\n}\n\nfunction create$Pattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  pattern: Pattern,\n  patternId: string,\n  width: number,\n  height: number,\n) {\n  const { repetition, transform } = pattern;\n\n  // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/pattern\n  const $pattern = createSVGElement('pattern', document) as SVGPatternElement;\n  if (transform) {\n    $pattern.setAttribute('patternTransform', formatTransform(transform));\n  }\n  $pattern.setAttribute('patternUnits', 'userSpaceOnUse');\n\n  $pattern.id = patternId;\n  $def.appendChild($pattern);\n\n  const { halfExtents, min } = object.getGeometryBounds();\n  $pattern.setAttribute('x', `${min[0]}`);\n  $pattern.setAttribute('y', `${min[1]}`);\n\n  // There is no equivalent to CSS no-repeat for SVG patterns\n  // @see https://stackoverflow.com/a/33481956\n  let patternWidth = width;\n  let patternHeight = height;\n  if (repetition === 'repeat-x') {\n    patternHeight = halfExtents[1] * 2;\n  } else if (repetition === 'repeat-y') {\n    patternWidth = halfExtents[0] * 2;\n  } else if (repetition === 'no-repeat') {\n    patternWidth = halfExtents[0] * 2;\n    patternHeight = halfExtents[1] * 2;\n  }\n  $pattern.setAttribute('width', `${patternWidth}`);\n  $pattern.setAttribute('height', `${patternHeight}`);\n\n  return $pattern;\n}\n\nfunction createOrUpdatePattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  pattern: Pattern,\n  createImage: (url: string) => HTMLImageElement,\n  plugin: SVGRendererPlugin,\n) {\n  const patternId = generateCacheKey(pattern);\n  const $existed = $def.querySelector(`#${patternId}`);\n  if (!$existed) {\n    const { image } = pattern;\n\n    let imageURL = '';\n    if (isString(image)) {\n      imageURL = image;\n    } else if (isBrowser) {\n      if (image instanceof HTMLImageElement) {\n        imageURL = image.src;\n      } else if (image instanceof HTMLCanvasElement) {\n        imageURL = image.toDataURL();\n      } else if (image instanceof HTMLVideoElement) {\n        // won't support\n      }\n    }\n\n    if (imageURL) {\n      const $image = createSVGElement('image', document);\n      // use href instead of xlink:href\n      // @see https://stackoverflow.com/a/13379007\n      $image.setAttribute('href', imageURL);\n\n      let img: HTMLImageElement;\n      if (createImage) {\n        img = createImage(imageURL);\n      } else if (isBrowser) {\n        img = new window.Image();\n      }\n      if (!imageURL.match(/^data:/i)) {\n        img.crossOrigin = 'Anonymous';\n        $image.setAttribute('crossorigin', 'anonymous');\n      }\n      img.src = imageURL;\n      const onload = function () {\n        const $pattern = create$Pattern(\n          document,\n          $def,\n          object,\n          pattern,\n          patternId,\n          img.width,\n          img.height,\n        );\n\n        $def.appendChild($pattern);\n        $pattern.appendChild($image);\n\n        $image.setAttribute('x', '0');\n        $image.setAttribute('y', '0');\n        $image.setAttribute('width', `${img.width}`);\n        $image.setAttribute('height', `${img.height}`);\n      };\n      if (img.complete) {\n        onload();\n      } else {\n        img.onload = onload;\n        // Fix onload() bug in IE9\n        // img.src = img.src;\n      }\n    }\n\n    if ((image as Rect).nodeName === 'rect') {\n      const { width, height } = (image as Rect).parsedStyle;\n\n      const $pattern = create$Pattern(\n        document,\n        $def,\n        image as Rect,\n        pattern,\n        patternId,\n        width,\n        height,\n      );\n\n      // traverse subtree of pattern\n      (image as Rect).forEach((object: DisplayObject) => {\n        plugin.createSVGDom(document, object, null);\n\n        // @ts-ignore\n        const svgElement = object.elementSVG;\n\n        // apply local RTS transformation to <group> wrapper\n        const localTransform = object.getLocalTransform();\n        plugin.applyTransform(svgElement.$groupEl, localTransform);\n      });\n\n      // @ts-ignore\n      const svgElement = image.elementSVG;\n      $pattern.appendChild(svgElement.$groupEl);\n    }\n  }\n  return patternId;\n}\n\nfunction createOrUpdateGradient(\n  document: Document,\n  object: DisplayObject,\n  $def: SVGDefsElement,\n  $el: SVGElement,\n  parsedColor: CSSGradientValue,\n) {\n  const bounds = object.getGeometryBounds();\n  const width = (bounds && bounds.halfExtents[0] * 2) || 0;\n  const height = (bounds && bounds.halfExtents[1] * 2) || 0;\n  const min = (bounds && bounds.min) || [0, 0];\n\n  const gradientId = generateCacheKey(parsedColor, {\n    x: min[0],\n    y: min[1],\n    width,\n    height,\n  });\n  let $existed = $def.querySelector(`#${gradientId}`);\n\n  if (!$existed) {\n    // <linearGradient> <radialGradient>\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/linearGradient\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/radialGradient\n    $existed = createSVGElement(\n      parsedColor.type === GradientType.LinearGradient\n        ? 'linearGradient'\n        : 'radialGradient',\n      document,\n    );\n    // @see https://github.com/antvis/g/issues/1025\n    $existed.setAttribute('gradientUnits', 'userSpaceOnUse');\n    // add stops\n    let innerHTML = '';\n    (parsedColor.value as LinearGradient).steps\n      // sort by offset @see https://github.com/antvis/G/issues/1171\n      .sort((a, b) => a.offset.value - b.offset.value)\n      .forEach(({ offset, color }) => {\n        // TODO: support absolute unit like `px`\n        innerHTML += `<stop offset=\"${\n          offset.value / 100\n        }\" stop-color=\"${color}\"></stop>`;\n      });\n    $existed.innerHTML = innerHTML;\n    $existed.id = gradientId;\n    $def.appendChild($existed);\n  }\n\n  if (parsedColor.type === GradientType.LinearGradient) {\n    const { angle } = parsedColor.value as LinearGradient;\n    const { x1, y1, x2, y2 } = computeLinearGradient(\n      [min[0], min[1]],\n      width,\n      height,\n      angle,\n    );\n\n    $existed.setAttribute('x1', `${x1}`);\n    $existed.setAttribute('y1', `${y1}`);\n    $existed.setAttribute('x2', `${x2}`);\n    $existed.setAttribute('y2', `${y2}`);\n\n    // $existed.setAttribute('gradientTransform', `rotate(${angle})`);\n  } else {\n    const { cx, cy, size } = parsedColor.value as RadialGradient;\n    const { x, y, r } = computeRadialGradient(\n      [min[0], min[1]],\n      width,\n      height,\n      cx,\n      cy,\n      size,\n    );\n\n    $existed.setAttribute('cx', `${x}`);\n    $existed.setAttribute('cy', `${y}`);\n    $existed.setAttribute('r', `${r}`);\n  }\n\n  return gradientId;\n}\n\nfunction createOrUpdateMultiGradient(\n  document: Document,\n  object: DisplayObject,\n  $def: SVGDefsElement,\n  $el: SVGElement,\n  gradients: CSSGradientValue[],\n) {\n  const filterId = `${FILTER_PREFIX + object.entity}-gradient`;\n  let $existed = $def.querySelector(`#${filterId}`);\n  if (!$existed) {\n    $existed = createSVGElement('filter', document) as SVGFilterElement;\n    $existed.setAttribute('filterUnits', 'userSpaceOnUse');\n    // @see https://github.com/antvis/g/issues/1025\n    $existed.setAttribute('x', '0%');\n    $existed.setAttribute('y', '0%');\n    $existed.setAttribute('width', '100%');\n    $existed.setAttribute('height', '100%');\n\n    $existed.id = filterId;\n\n    $def.appendChild($existed);\n  }\n\n  /**\n   * <rect id=\"wave-rect\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"url(#wave)\"></rect>\n   * <filter id=\"blend-it\" x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\">\n        <feImage xlink:href=\"#wave-rect\" result=\"myWave\" x=\"100\" y=\"100\"/>\n        <feImage xlink:href=\"#ry-rect\" result=\"myRY\"  x=\"100\" y=\"100\"/>\n        <feBlend in=\"myWave\" in2=\"myRY\" mode=\"multiply\" result=\"blendedGrad\"/>\n        <feComposite in=\"blendedGrad\" in2=\"SourceGraphic\" operator=\"in\"/>\n    </filter>\n   */\n\n  let blended = 0;\n  gradients.forEach((gradient, i) => {\n    const gradientId = createOrUpdateGradient(\n      document,\n      object,\n      $def,\n      $el,\n      gradient,\n    );\n\n    const rectId = `${gradientId}_rect`;\n    const $rect = createSVGElement('rect', document) as SVGRectElement;\n    $rect.setAttribute('x', '0');\n    $rect.setAttribute('y', '0');\n    $rect.setAttribute('width', '100%');\n    $rect.setAttribute('height', '100%');\n    $rect.setAttribute('fill', `url(#${gradientId})`);\n    $rect.id = rectId;\n    $def.appendChild($rect);\n\n    const $feImage = createSVGElement('feImage', document) as SVGFEImageElement;\n    $feImage.setAttribute('href', `#${rectId}`);\n    $feImage.setAttribute('result', `${filterId}-${i}`);\n    $existed.appendChild($feImage);\n\n    if (i > 0) {\n      const $feBlend = createSVGElement(\n        'feBlend',\n        document,\n      ) as SVGFEBlendElement;\n      $feBlend.setAttribute(\n        'in',\n        i === 1 ? `${filterId}-${i - 1}` : `${filterId}-blended-${blended - 1}`,\n      );\n      $feBlend.setAttribute('in2', `${filterId}-${i}`);\n      $feBlend.setAttribute('result', `${filterId}-blended-${blended++}`);\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/blend-mode\n      $feBlend.setAttribute('mode', 'multiply');\n      $existed.appendChild($feBlend);\n    }\n  });\n\n  const $feComposite = createSVGElement(\n    'feComposite',\n    document,\n  ) as SVGFECompositeElement;\n  $feComposite.setAttribute('in', `${filterId}-blended-${blended}`);\n  $feComposite.setAttribute('in2', 'SourceGraphic');\n  $feComposite.setAttribute('operator', 'in');\n  $existed.appendChild($feComposite);\n\n  return filterId;\n}\n","import type { DisplayObject } from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { createSVGElement } from '../../utils/dom';\n\nconst FILTER_DROPSHADOW_PREFIX = 'g-filter-dropshadow-';\n\n/**\n * use SVG filters\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nexport function createOrUpdateShadow(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  name: string,\n) {\n  const {\n    shadowType = 'outer',\n    shadowBlur,\n    shadowColor,\n    shadowOffsetX,\n    shadowOffsetY,\n  } = object.parsedStyle;\n\n  const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n  const shadowId = FILTER_DROPSHADOW_PREFIX + object.entity;\n  let $existedFilter = $def.querySelector(`#${shadowId}`);\n  if ($existedFilter) {\n    const existedShadowType = $existedFilter.getAttribute('data-type');\n    if (existedShadowType !== shadowType || !hasShadow) {\n      // remove existed shadow\n      $existedFilter.remove();\n      $existedFilter = null;\n    }\n  }\n\n  // <Group> also has shadowType as its default value\n  // only apply shadow when blur > 0\n  if (hasShadow) {\n    // use filter <feDropShadow>\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feDropShadow\n    $el?.setAttribute('filter', `url(#${shadowId})`);\n  } else {\n    $el?.removeAttribute('filter');\n    return;\n  }\n\n  if (!$existedFilter) {\n    $existedFilter = createSVGElement('filter', document) as SVGFilterElement;\n    $existedFilter.setAttribute('data-type', shadowType);\n\n    if (shadowType === 'outer') {\n      const $feDropShadow = createSVGElement('feDropShadow', document);\n      $feDropShadow.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n      $feDropShadow.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n      $feDropShadow.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n      $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n      $existedFilter.appendChild($feDropShadow);\n    } else if (shadowType === 'inner') {\n      const $feComponentTransfer = createSVGElement(\n        'feComponentTransfer',\n        document,\n      );\n      $feComponentTransfer.setAttribute('in', 'SourceAlpha');\n      const $feFuncA = createSVGElement('feFuncA', document);\n      $feFuncA.setAttribute('type', 'table');\n      $feFuncA.setAttribute('tableValues', '1 0');\n      $feComponentTransfer.appendChild($feFuncA);\n      $existedFilter.appendChild($feComponentTransfer);\n\n      const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n      $feGaussianBlur.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n      $existedFilter.appendChild($feGaussianBlur);\n\n      const $feOffset = createSVGElement('feOffset', document);\n      $feOffset.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n      $feOffset.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n      $feOffset.setAttribute('result', 'offsetblur');\n      $existedFilter.appendChild($feOffset);\n\n      const $feFlood = createSVGElement('feFlood', document);\n      $feFlood.setAttribute('flood-color', shadowColor.toString());\n      $feFlood.setAttribute('result', 'color');\n      $existedFilter.appendChild($feFlood);\n\n      const $feComposite = createSVGElement('feComposite', document);\n      $feComposite.setAttribute('in2', 'offsetblur');\n      $feComposite.setAttribute('operator', 'in');\n      $existedFilter.appendChild($feComposite);\n\n      const $feComposite2 = createSVGElement('feComposite', document);\n      $feComposite2.setAttribute('in2', 'SourceAlpha');\n      $feComposite2.setAttribute('operator', 'in');\n      $existedFilter.appendChild($feComposite2);\n\n      const $feMerge = createSVGElement('feMerge', document);\n      $existedFilter.appendChild($feMerge);\n      const $feMergeNode = createSVGElement('feMergeNode', document);\n      $feMergeNode.setAttribute('in', 'SourceGraphic');\n      const $feMergeNode2 = createSVGElement('feMergeNode', document);\n      $feMerge.appendChild($feMergeNode);\n      $feMerge.appendChild($feMergeNode2);\n    }\n\n    $existedFilter.id = shadowId;\n    // @see https://github.com/antvis/g/issues/1025\n    $existedFilter.setAttribute('filterUnits', 'userSpaceOnUse');\n    $def.appendChild($existedFilter);\n    return;\n  }\n\n  if (shadowType === 'inner') {\n    const $feGaussianBlur = $existedFilter\n      .children[1] as SVGFEGaussianBlurElement;\n    const $feOffset = $existedFilter.children[2] as SVGFEOffsetElement;\n    const $feFlood = $existedFilter.children[3] as SVGFEFloodElement;\n    if (name === 'shadowColor') {\n      $feFlood.setAttribute('flood-color', shadowColor.toString());\n    } else if (name === 'shadowBlur') {\n      // half the blur radius\n      // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n      // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n      $feGaussianBlur.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n    } else if (name === 'shadowOffsetX') {\n      $feOffset.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n    } else if (name === 'shadowOffsetY') {\n      $feOffset.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n    }\n  } else if (shadowType === 'outer') {\n    const $feDropShadow = $existedFilter.children[0] as SVGPatternElement;\n    if (name === 'shadowColor') {\n      $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n    } else if (name === 'shadowBlur') {\n      // half the blur radius\n      // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n      // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n      $feDropShadow.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n    } else if (name === 'shadowOffsetX') {\n      $feDropShadow.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n    } else if (name === 'shadowOffsetY') {\n      $feDropShadow.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n    }\n  }\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  CSSRGB,\n  DisplayObject,\n  ParsedBaseStyleProps,\n  Pattern,\n  ContextService,\n  isPattern,\n} from '@antv/g-lite';\nimport { SVGRendererPlugin } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { createOrUpdateFilter } from './Filter';\nimport { createOrUpdateGradientAndPattern } from './Pattern';\nimport { createOrUpdateShadow } from './Shadow';\n\nconst urlRegexp = /url\\(\"?#(.*)\\)/;\n\nexport class DefElementManager {\n  constructor(private context: CanvasContext) {}\n\n  /**\n   * container for <gradient> <clipPath>...\n   */\n  private $def: SVGDefsElement;\n\n  private gradientCache: Record<string, Set<number>> = {};\n\n  getDefElement() {\n    return this.$def;\n  }\n\n  init() {\n    const { document } = this.context.config;\n    const $svg = (\n      this.context.contextService as ContextService<SVGElement>\n    ).getContext();\n    this.$def = createSVGElement('defs', document) as SVGDefsElement;\n    $svg.appendChild(this.$def);\n  }\n\n  clear(entity: number) {\n    Object.keys(this.gradientCache).forEach((id) => {\n      this.clearUnusedDefElement(this.gradientCache, id, entity);\n    });\n  }\n\n  private clearUnusedDefElement(\n    cache: Record<string, Set<number>>,\n    id: string,\n    entity: number,\n  ) {\n    if (cache[id] && cache[id].size === 1 && cache[id].has(entity)) {\n      const targetElement = this.$def.querySelector(`#${id}`);\n      if (targetElement) {\n        this.$def.removeChild(targetElement);\n      }\n    }\n  }\n\n  createOrUpdateGradientAndPattern(\n    object: DisplayObject,\n    $el: SVGElement,\n    parsedColor: CSSGradientValue[] | CSSRGB | Pattern,\n    name: string,\n    plugin: SVGRendererPlugin,\n  ) {\n    const { document: doc, createImage } = this.context.config;\n\n    if ($el) {\n      let attributeValue = '';\n      if (isPattern(parsedColor)) {\n        // `fill: url(#${patternId})`\n        attributeValue = $el.style[name];\n      } else {\n        // `url(#${gradientId})`\n        attributeValue = $el.getAttribute(name) || '';\n      }\n\n      const matches = attributeValue.match(urlRegexp);\n      if (matches && matches.length > 1) {\n        this.clearUnusedDefElement(\n          this.gradientCache,\n          matches[1].replace('\"', ''),\n          object.entity,\n        );\n      }\n\n      const newDefElementId = createOrUpdateGradientAndPattern(\n        doc || document,\n        this.$def,\n        object,\n        $el,\n        parsedColor,\n        name,\n        createImage,\n        plugin,\n      );\n      if (newDefElementId) {\n        if (!this.gradientCache[newDefElementId]) {\n          this.gradientCache[newDefElementId] = new Set();\n        }\n        this.gradientCache[newDefElementId].add(object.entity);\n      }\n    }\n  }\n\n  createOrUpdateShadow(object: DisplayObject, $el: SVGElement, name: string) {\n    const { document: doc } = this.context.config;\n    createOrUpdateShadow(doc || document, this.$def, object, $el, name);\n  }\n\n  createOrUpdateFilter(\n    object: DisplayObject,\n    $el: SVGElement,\n    filters: ParsedBaseStyleProps['filter'],\n  ) {\n    const { document: doc } = this.context.config;\n    createOrUpdateFilter(doc || document, this.$def, object, $el, filters);\n  }\n}\n","export function numberToLongString(x: number) {\n  return x.toFixed(6).replace('.000000', '');\n}\n\nexport function convertHTML(str: string) {\n  const regex = /[&|<|>|\"|']/g;\n  return str.replace(regex, function (match) {\n    if (match === '&') {\n      return '&amp;';\n    }\n    if (match === '<') {\n      return '&lt;';\n    }\n    if (match === '>') {\n      return '&gt;';\n    }\n    if (match === '\"') {\n      return '&quot;';\n    }\n    return '&apos;';\n  });\n}\n","import {\n  DisplayObject,\n  FederatedEvent,\n  LinearGradient,\n  MutationEvent,\n  RadialGradient,\n  RenderingPlugin,\n  RenderingPluginContext,\n  ContextService,\n  ElementEvent,\n  propertyMetadataCache,\n  RenderReason,\n  Shape,\n  isCSSRGB,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport { ElementSVG } from './components/ElementSVG';\nimport { resetPatternCounter, type DefElementManager } from './shapes/defs';\nimport type { SVGRendererPluginOptions } from './interfaces';\nimport { createSVGElement } from './utils/dom';\nimport { numberToLongString } from './utils/format';\n\nexport const SVG_ATTR_MAP: Record<string, string> = {\n  opacity: 'opacity',\n  fillStyle: 'fill',\n  fill: 'fill',\n  fillRule: 'fill-rule',\n  fillOpacity: 'fill-opacity',\n  strokeStyle: 'stroke',\n  strokeOpacity: 'stroke-opacity',\n  stroke: 'stroke',\n  clipPath: 'clip-path',\n  textPath: 'text-path',\n  r: 'r',\n  cx: 'cx',\n  cy: 'cy',\n  rx: 'rx',\n  ry: 'ry',\n  x: 'x',\n  y: 'y',\n  width: 'width',\n  height: 'height',\n  lineCap: 'stroke-linecap',\n  lineJoin: 'stroke-linejoin',\n  lineWidth: 'stroke-width',\n  lineDash: 'stroke-dasharray',\n  lineDashOffset: 'stroke-dashoffset',\n  miterLimit: 'stroke-miterlimit',\n  font: 'font',\n  fontSize: 'font-size',\n  fontStyle: 'font-style',\n  fontVariant: 'font-variant',\n  fontWeight: 'font-weight',\n  fontFamily: 'font-family',\n  letterSpacing: 'letter-spacing',\n  startArrow: 'marker-start',\n  endArrow: 'marker-end',\n  class: 'class',\n  id: 'id',\n  // style: 'style',\n  preserveAspectRatio: 'preserveAspectRatio',\n  visibility: 'visibility',\n  shadowColor: 'flood-color',\n  shadowBlur: 'stdDeviation',\n  shadowOffsetX: 'dx',\n  shadowOffsetY: 'dy',\n  filter: 'filter',\n  innerHTML: 'innerHTML',\n  textAlign: 'text-anchor',\n  pointerEvents: 'pointer-events',\n};\n\nconst FORMAT_VALUE_MAP = {\n  textAlign: {\n    inherit: 'inherit',\n    left: 'left',\n    start: 'left',\n    center: 'middle',\n    right: 'end',\n    end: 'end',\n  },\n};\n\nexport const DEFAULT_VALUE_MAP: Record<string, string> = {\n  textAlign: 'inherit',\n  // textBaseline: 'alphabetic',\n  // @see https://www.w3.org/TR/SVG/painting.html#LineCaps\n  lineCap: 'butt',\n  // @see https://www.w3.org/TR/SVG/painting.html#LineJoin\n  lineJoin: 'miter',\n  // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/stroke-width\n  lineWidth: '1px',\n  opacity: '1',\n  fillOpacity: '1',\n  fillRule: 'nonzero',\n  strokeOpacity: '1',\n  strokeWidth: '0',\n  strokeMiterLimit: '4',\n  letterSpacing: '0',\n  fontSize: 'inherit',\n  fontFamily: 'inherit',\n  pointerEvents: 'auto',\n  transform: 'matrix(1,0,0,1,0,0)',\n};\n\nexport type GradientParams = LinearGradient | RadialGradient;\n\n/**\n * G_SVG_PREFIX + nodeName + entity\n *\n * eg. g_svg_circle_345\n */\nexport const G_SVG_PREFIX = 'g-svg';\nexport const CLIP_PATH_PREFIX = 'clip-path-';\nexport const TEXT_PATH_PREFIX = 'text-path-';\n\nexport class SVGRendererPlugin implements RenderingPlugin {\n  static tag = 'SVGRenderer';\n\n  constructor(\n    private pluginOptions: SVGRendererPluginOptions,\n    private defElementManager: DefElementManager,\n    private context: RenderingPluginContext,\n  ) {}\n\n  /**\n   * Will be used in g-plugin-svg-picker for finding relative SVG element of current DisplayObject.\n   */\n  private svgElementMap: WeakMap<SVGElement, DisplayObject> = new WeakMap();\n\n  /**\n   * <camera>\n   */\n  private $camera: SVGElement;\n\n  /**\n   * render at the end of frame\n   */\n  private renderQueue: DisplayObject[] = [];\n\n  /**\n   * dirty attributes at the end of frame\n   */\n  private dirtyAttributes: WeakMap<DisplayObject, string[]> = new WeakMap();\n\n  /**\n   * reorder after mounted\n   */\n  private pendingReorderQueue: Set<DisplayObject> = new Set();\n\n  /**\n   * <use> elements in <clipPath>, which should be sync with clipPath\n   *\n   * @example\n   * <clipPath transform=\"matrix(1,0,0,1,-100,-155)\" id=\"clip-path-0-2\">\n   *  <use href=\"#g_svg_circle_0\" transform=\"matrix(1.477115,0,0,1.477115,150,150)\">\n   *  </use>\n   * </clipPath>\n   */\n  private clipPathUseMap: WeakMap<DisplayObject, SVGUseElement[]> =\n    new WeakMap();\n\n  apply(context: RenderingPluginContext) {\n    const { renderingService, renderingContext } = context;\n    this.context = context;\n    // @ts-ignore\n    this.context.svgElementMap = this.svgElementMap;\n    const canvas = renderingContext.root.ownerDocument.defaultView;\n\n    const { document } = this.context.config;\n\n    const handleMounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n\n      // should remove clipPath already existed in <defs>\n      const $useRefs = this.clipPathUseMap.get(object);\n      if ($useRefs) {\n        const $def = this.defElementManager.getDefElement();\n        const existed = $def.querySelector(`#${this.getId(object)}`);\n        if (existed) {\n          existed.remove();\n        }\n      }\n\n      // create SVG DOM Node\n      this.createSVGDom(document, object, this.$camera);\n    };\n\n    const handleUnmounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      this.defElementManager.clear(object.entity);\n      this.clipPathUseMap.delete(object);\n      this.removeSVGDom(object);\n    };\n\n    const reorderChildren = (object: DisplayObject) => {\n      const parent = object.parentNode;\n      // @ts-ignore\n      const $groupEl = object.parentNode?.elementSVG?.$groupEl;\n      const children = (parent?.children || []).slice();\n\n      if ($groupEl) {\n        this.reorderChildren(document, $groupEl, children as DisplayObject[]);\n      }\n    };\n\n    const handleReparent = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      reorderChildren(object);\n    };\n\n    const handleAttributeChanged = (e: MutationEvent) => {\n      const object = e.target as DisplayObject;\n\n      // @see https://github.com/antvis/g/issues/994\n      // @ts-ignore\n      if (!object.elementSVG) {\n        return;\n      }\n\n      const { attrName } = e;\n\n      let attribtues = this.dirtyAttributes.get(object);\n      if (!attribtues) {\n        this.dirtyAttributes.set(object, []);\n        attribtues = this.dirtyAttributes.get(object);\n      }\n\n      attribtues.push(attrName);\n    };\n\n    const handleGeometryBoundsChanged = (e: MutationEvent) => {\n      const target = e.target as DisplayObject;\n\n      const nodes =\n        target.nodeName === Shape.FRAGMENT ? target.childNodes : [target];\n      nodes.forEach((object: DisplayObject) => {\n        // @ts-ignore\n        const $el = object.elementSVG?.$el;\n\n        const { fill, stroke, clipPath } = object.parsedStyle;\n\n        if (fill && !isCSSRGB(fill)) {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            fill,\n            'fill',\n            this,\n          );\n        }\n        if (stroke && !isCSSRGB(stroke)) {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            stroke,\n            'stroke',\n            this,\n          );\n        }\n        if (clipPath) {\n          const parentInvert = mat4.invert(\n            mat4.create(),\n            object.getWorldTransform(),\n          );\n\n          const clipPathId = `${CLIP_PATH_PREFIX + clipPath.entity}-${object.entity}`;\n          const $def = this.defElementManager.getDefElement();\n          const $existed = $def.querySelector<SVGElement>(`#${clipPathId}`);\n          if ($existed) {\n            this.applyTransform($existed, parentInvert);\n          }\n        }\n      });\n    };\n\n    renderingService.hooks.init.tap(SVGRendererPlugin.tag, () => {\n      const { background, document } = this.context.config;\n\n      // <defs>\n      this.defElementManager.init();\n\n      const $svg = (\n        this.context.contextService as ContextService<SVGElement>\n      ).getContext();\n      if (background) {\n        $svg.style.background = background;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/color-interpolation-filters\n      $svg.setAttribute('color-interpolation-filters', 'sRGB');\n\n      this.$camera = createSVGElement('g', document);\n      this.$camera.id = `${G_SVG_PREFIX}-camera`;\n      this.applyTransform(this.$camera, this.context.camera.getOrthoMatrix());\n      $svg.appendChild(this.$camera);\n\n      canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n      canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.addEventListener(ElementEvent.REPARENT, handleReparent);\n      canvas.addEventListener(\n        ElementEvent.ATTR_MODIFIED,\n        handleAttributeChanged,\n      );\n      canvas.addEventListener(\n        ElementEvent.BOUNDS_CHANGED,\n        handleGeometryBoundsChanged,\n      );\n    });\n\n    renderingService.hooks.destroy.tap(SVGRendererPlugin.tag, () => {\n      canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n      canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.removeEventListener(ElementEvent.REPARENT, handleReparent);\n      canvas.removeEventListener(\n        ElementEvent.ATTR_MODIFIED,\n        handleAttributeChanged,\n      );\n      canvas.removeEventListener(\n        ElementEvent.BOUNDS_CHANGED,\n        handleGeometryBoundsChanged,\n      );\n      resetPatternCounter();\n    });\n\n    renderingService.hooks.render.tap(\n      SVGRendererPlugin.tag,\n      (object: DisplayObject) => {\n        this.renderQueue.push(object);\n      },\n    );\n\n    renderingService.hooks.beginFrame.tap(SVGRendererPlugin.tag, () => {\n      const { document: doc } = this.context.config;\n\n      if (this.pendingReorderQueue.size) {\n        this.pendingReorderQueue.forEach((object) => {\n          const children = (object?.children || []).slice() as DisplayObject[];\n          const $parentGroupEl =\n            // @ts-ignore\n            object?.elementSVG?.$groupEl;\n\n          if ($parentGroupEl) {\n            this.reorderChildren(\n              doc || document,\n              $parentGroupEl,\n              children || [],\n            );\n          }\n        });\n        this.pendingReorderQueue.clear();\n      }\n    });\n\n    renderingService.hooks.endFrame.tap(SVGRendererPlugin.tag, () => {\n      if (renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)) {\n        this.applyTransform(this.$camera, this.context.camera.getOrthoMatrix());\n      }\n\n      this.renderQueue.forEach((object) => {\n        const $el = ((object as any).elementSVG as ElementSVG)?.$el;\n        const $groupEl = ((object as any).elementSVG as ElementSVG)?.$groupEl;\n\n        if ($el && $groupEl) {\n          // apply local RTS transformation to <group> wrapper\n          // account for anchor\n          const localTransform = object.getLocalTransform();\n          this.applyTransform($groupEl, localTransform);\n\n          // clipped shapes should also be informed\n\n          const $useRefs = this.clipPathUseMap.get(object);\n          if ($useRefs && $useRefs.length) {\n            $useRefs.forEach(($use) => {\n              // <clipPath transform=\"matrix()\"><circle /></clipPath>\n              this.applyTransform($use, object.getWorldTransform());\n              // const parentInvert = mat4.invert(\n              //   mat4.create(),\n              //   (object as DisplayObject).getWorldTransform(),\n              // );\n              // this.applyTransform($clipPath, parentInvert);\n            });\n          }\n\n          // finish rendering, clear dirty flag\n          object.renderable.dirty = false;\n        }\n\n        // update dirty attributes\n        const attributes = this.dirtyAttributes.get(object);\n        if (attributes) {\n          attributes.forEach((attrName) => {\n            if (attrName === 'zIndex') {\n              reorderChildren(object);\n            } else if (attrName === 'increasedLineWidthForHitTesting') {\n              this.createOrUpdateHitArea(object, $el, $groupEl);\n            }\n\n            this.updateAttribute(object, [attrName]);\n          });\n\n          this.dirtyAttributes.delete(object);\n        }\n      });\n      this.renderQueue = [];\n    });\n  }\n\n  private getId(object: DisplayObject) {\n    return object.id || `${G_SVG_PREFIX}-${object.entity}`;\n  }\n\n  private reorderChildren(\n    doc: Document,\n    $groupEl: SVGElement,\n    children: DisplayObject[],\n  ) {\n    // need to reorder parent's children\n    children.sort((a, b) => a.sortable.renderOrder - b.sortable.renderOrder);\n\n    if (children.length) {\n      // create empty fragment\n      const fragment = (doc || document).createDocumentFragment();\n      children.forEach((child: DisplayObject) => {\n        if (child.isConnected) {\n          const $el = ((child as any).elementSVG as ElementSVG).$groupEl;\n          if ($el) {\n            fragment.appendChild($el);\n          }\n        }\n      });\n\n      $groupEl.appendChild(fragment);\n    }\n  }\n\n  applyTransform($el: SVGElement, rts: mat4) {\n    const matrix = `matrix(${numberToLongString(rts[0])},${numberToLongString(\n      rts[1],\n    )},${numberToLongString(rts[4])},${numberToLongString(\n      rts[5],\n    )},${numberToLongString(rts[12])},${numberToLongString(rts[13])})`;\n\n    if (matrix !== $el.getAttribute('transform')) {\n      // use proper precision avoiding too long string in `transform`\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n      $el.setAttribute('transform', matrix);\n    }\n    if (matrix === DEFAULT_VALUE_MAP.transform) {\n      $el.removeAttribute('transform');\n    }\n  }\n\n  private applyAttributes(object: DisplayObject) {\n    const elementSVG = (object as any).elementSVG as ElementSVG;\n    const $el = elementSVG?.$el;\n    const $groupEl = elementSVG?.$groupEl;\n    if ($el && $groupEl) {\n      const { nodeName, attributes } = object;\n\n      if (nodeName !== Shape.HTML) {\n        $el.setAttribute('fill', 'none');\n      }\n      if (nodeName === Shape.IMAGE) {\n        $el.setAttribute('preserveAspectRatio', 'none');\n      }\n\n      // apply attributes\n      this.updateAttribute(object, Object.keys(attributes));\n    }\n  }\n\n  private updateAttribute(object: DisplayObject, attributes: string[]) {\n    const { document } = this.context.config;\n\n    const { $el, $hitTestingEl } = (object as any).elementSVG as ElementSVG;\n    const { parsedStyle, nodeName } = object;\n    const shouldUpdateElementAttribute = attributes.some((name) =>\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.shouldUpdateElementAttribute(\n        object,\n        name,\n      ),\n    );\n\n    // need re-generate path\n    if (shouldUpdateElementAttribute && $el) {\n      [$el, $hitTestingEl].forEach(($el) => {\n        if ($el) {\n          // @ts-ignore\n          this.context.SVGElementLifeCycleContribution.updateElementAttribute(\n            object,\n            $el,\n            this.svgElementMap,\n          );\n        }\n      });\n    }\n\n    // update common attributes\n    attributes.forEach((name) => {\n      const usedName = SVG_ATTR_MAP[name];\n      const computedValue = parsedStyle[name];\n      const computedValueStr =\n        !isNil(computedValue) && computedValue.toString();\n      const formattedValueStr =\n        FORMAT_VALUE_MAP[name]?.[computedValueStr] || computedValueStr;\n      const usedValue = parsedStyle[name];\n      const inherited = usedName && !!propertyMetadataCache[name]?.inh;\n\n      // <foreignObject>\n      if (nodeName === Shape.HTML) {\n        if (name === 'fill') {\n          $el.style.background = usedValue.toString();\n        } else if (name === 'stroke') {\n          $el.style['border-color'] = usedValue.toString();\n          $el.style['border-style'] = 'solid';\n        } else if (name === 'lineWidth') {\n          $el.style['border-width'] = `${usedValue || 0}px`;\n        } else if (name === 'lineDash') {\n          $el.style['border-style'] = 'dashed';\n        } else if (name === 'innerHTML') {\n          this.createOrUpdateInnerHTML(document, $el, usedValue);\n        } else if (name === 'width' || name === 'height' || name === 'class') {\n          // width & height are both required for <foreignObject> and cannot be used as style.\n          $el.setAttribute(name, usedValue.toString());\n        } else if (!isNil(object.style[name]) && object.style[name] !== '') {\n          $el.style[name] = object.style[name];\n        }\n      } else {\n        if (\n          !usedName ||\n          ((nodeName === Shape.GROUP || object.isCustomElement) &&\n            (inherited || usedName === 'fill' || usedName === 'stroke'))\n        ) {\n          return;\n        }\n\n        if (name === 'fill') {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            usedValue,\n            usedName,\n            this,\n          );\n        } else if (name === 'stroke') {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            usedValue,\n            usedName,\n            this,\n          );\n        } else if (name === 'clipPath') {\n          this.createOrUpdateClipOrTextPath(document, usedValue, object);\n        } else if (name === 'textPath') {\n          this.createOrUpdateClipOrTextPath(document, usedValue, object, true);\n        } else if (\n          name === 'shadowType' ||\n          name === 'shadowColor' ||\n          name === 'shadowBlur' ||\n          name === 'shadowOffsetX' ||\n          name === 'shadowOffsetY'\n        ) {\n          this.defElementManager.createOrUpdateShadow(object, $el, name);\n        } else if (name === 'filter') {\n          this.defElementManager.createOrUpdateFilter(object, $el, usedValue);\n        } else if (!isNil(computedValue)) {\n          // use computed value so that we can use cascaded effect in SVG\n          // ignore 'unset' and default value\n          [$el, $hitTestingEl].forEach(($el: SVGElement) => {\n            if ($el && usedName) {\n              if (\n                computedValueStr !== 'unset' &&\n                computedValueStr !== DEFAULT_VALUE_MAP[name]\n              ) {\n                $el.setAttribute(usedName, formattedValueStr);\n              } else {\n                $el.removeAttribute(usedName);\n              }\n            }\n          });\n        }\n      }\n    });\n  }\n\n  createSVGDom(\n    document: Document,\n    object: DisplayObject,\n    root: SVGElement,\n    noWrapWithGroup = false,\n  ) {\n    // create svg element\n    // @ts-ignore\n    object.elementSVG = new ElementSVG();\n    // @ts-ignore\n    const svgElement = object.elementSVG;\n\n    // use <group> as default, eg. CustomElement\n    const $el =\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.createElement(\n        object,\n        this.svgElementMap,\n      );\n    if ($el) {\n      let $groupEl: SVGElement;\n\n      // save $el on parsedStyle, which will be returned in getDomElement()\n      if (object.nodeName === Shape.HTML) {\n        object.parsedStyle.$el = $el;\n      }\n\n      if (this.pluginOptions.outputSVGElementId) {\n        // use user-defined id first.\n        $el.id = this.getId(object);\n      }\n      if (this.pluginOptions.outputSVGElementName && object.name) {\n        $el.setAttribute('name', object.name);\n      }\n\n      if (\n        ($el.hasAttribute('data-wrapgroup') || $el.nodeName !== 'g') &&\n        !noWrapWithGroup\n      ) {\n        $groupEl = createSVGElement('g', document);\n        // if (this.pluginOptions.outputSVGElementId) {\n        //   $groupEl.id = $el.id + '-g';\n        // }\n        $groupEl.appendChild($el);\n      } else {\n        $groupEl = $el;\n      }\n\n      svgElement.$el = $el;\n      svgElement.$groupEl = $groupEl;\n\n      // apply attributes at first time\n      this.applyAttributes(object);\n\n      // create hitArea if necessary\n      this.createOrUpdateHitArea(object, $el, $groupEl);\n\n      const $parentGroupEl =\n        root ||\n        // @ts-ignore\n        (object.parentNode && object.parentNode.elementSVG?.$groupEl);\n\n      if ($parentGroupEl) {\n        $parentGroupEl.appendChild($groupEl);\n\n        // need reorder children later\n        this.pendingReorderQueue.add(object.parentNode as DisplayObject);\n      }\n    }\n  }\n\n  private removeSVGDom(object: DisplayObject) {\n    // @ts-ignore\n    const $groupEl = object.elementSVG?.$groupEl;\n    if ($groupEl && $groupEl.parentNode) {\n      $groupEl.parentNode.removeChild($groupEl);\n\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.destroyElement(\n        object,\n        $groupEl,\n      );\n      // object.entity.removeComponent(ElementSVG, true);\n    }\n  }\n\n  private createOrUpdateHitArea(\n    object: DisplayObject,\n    $el: SVGElement,\n    $groupEl: SVGElement,\n  ) {\n    const svgElement = (object as any).elementSVG as ElementSVG;\n    let { $hitTestingEl } = svgElement;\n    const increasedLineWidthForHitTesting = Number(\n      object.parsedStyle.increasedLineWidthForHitTesting,\n    );\n\n    // account for hitArea\n    if (increasedLineWidthForHitTesting) {\n      if (!$hitTestingEl) {\n        $hitTestingEl = $el.cloneNode() as SVGElement;\n        // clear attributes like `filter` `font-size`\n        ['filter'].forEach((attribute) => {\n          $hitTestingEl.removeAttribute(attribute);\n        });\n        // hitArea should be 'transparent' but not 'none'\n        const hasFill = $el.getAttribute('fill') !== 'none';\n        $hitTestingEl.setAttribute('fill', hasFill ? 'transparent' : 'none');\n        $hitTestingEl.setAttribute('stroke', 'transparent');\n        $groupEl.appendChild($hitTestingEl);\n        svgElement.$hitTestingEl = $hitTestingEl;\n\n        // g-plugin-svg-picker will use this map to find target object\n        this.svgElementMap.set($hitTestingEl, object);\n      }\n\n      // increase interactive line width\n      $hitTestingEl.setAttribute(\n        'stroke-width',\n        `${increasedLineWidthForHitTesting + object.parsedStyle.lineWidth}`,\n      );\n    } else if ($hitTestingEl) {\n      $groupEl.removeChild($hitTestingEl);\n      svgElement.$hitTestingEl = null;\n    }\n  }\n\n  private createOrUpdateInnerHTML(\n    doc: Document,\n    $el: SVGElement,\n    usedValue: any,\n  ) {\n    const $div = (doc || document).createElement('div');\n    if (typeof usedValue === 'string') {\n      $div.innerHTML = usedValue;\n    } else {\n      $div.appendChild(usedValue);\n    }\n    $el.innerHTML = '';\n    $el.appendChild($div);\n  }\n\n  private createOrUpdateClipOrTextPath(\n    document: Document,\n    clipPath: DisplayObject,\n    object: DisplayObject,\n    isTextPath = false,\n  ) {\n    const { $groupEl } = (object as any).elementSVG as ElementSVG;\n    const PREFIX = isTextPath ? TEXT_PATH_PREFIX : CLIP_PATH_PREFIX;\n    const attributeNameCamel = isTextPath ? 'g' : 'clipPath';\n    const attributeNameHyphen = isTextPath ? 'text-path' : 'clip-path';\n\n    if (clipPath) {\n      const clipPathId = `${PREFIX + clipPath.entity}-${object.entity}`;\n      const $def = this.defElementManager.getDefElement();\n\n      const existed = $def.querySelector(`#${clipPathId}`);\n      if (!existed) {\n        let $clipPath: SVGElement;\n        if (isTextPath) {\n          // use <path> directly instead of wrapping with <g>\n          this.createSVGDom(document, clipPath, null, true);\n          // @ts-ignore\n          $clipPath = clipPath.elementSVG.$el;\n        } else {\n          // the clipPath is allowed to be detached from canvas\n          if (!clipPath.isConnected) {\n            const $existedClipPath = $def.querySelector(\n              `#${this.getId(clipPath)}`,\n            );\n            if (!$existedClipPath) {\n              this.createSVGDom(document, clipPath, $def, true);\n            }\n          }\n\n          // create <clipPath> dom node\n          $clipPath = createSVGElement(attributeNameCamel, document);\n          const $use = createSVGElement('use', document) as SVGUseElement;\n          // @ts-ignore\n          $use.setAttribute('href', `#${clipPath.elementSVG.$el.id}`);\n          $clipPath.appendChild($use);\n\n          let $useRefs = this.clipPathUseMap.get(clipPath);\n          if (!$useRefs) {\n            this.clipPathUseMap.set(clipPath, []);\n            $useRefs = this.clipPathUseMap.get(clipPath);\n          }\n          $useRefs.push($use);\n\n          // <clipPath transform=\"matrix()\"><circle /></clipPath>\n          this.applyTransform($use, clipPath.getWorldTransform());\n          const parentInvert = mat4.invert(\n            mat4.create(),\n            object.getWorldTransform(),\n          );\n          this.applyTransform($clipPath, parentInvert);\n        }\n\n        if (this.pluginOptions.outputSVGElementId) {\n          $clipPath.id = clipPathId;\n        }\n        // append it to <defs>\n        $def.appendChild($clipPath);\n      }\n\n      // apply attributes\n      this.applyAttributes(clipPath);\n\n      if (!isTextPath) {\n        // apply clipPath to $group\n        // @see https://github.com/antvis/g/issues/961\n        $groupEl.setAttribute(attributeNameHyphen, `url(#${clipPathId})`);\n      }\n    } else if (!isTextPath) {\n      // remove clip path\n      $groupEl.removeAttribute(attributeNameHyphen);\n    }\n  }\n}\n","import type { GlobalRuntime, ParsedTextStyleProps, Text } from '@antv/g-lite';\nimport { TEXT_PATH_PREFIX } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { convertHTML } from '../../utils/format';\n\n// @see https://github.com/plouc/nivo/issues/164\nconst BASELINE_MAP: Record<string, string> = {\n  top: 'hanging', // Use hanging here.\n  middle: 'central',\n  bottom: 'text-after-edge', // FIXME: It is not a standard property.\n  alphabetic: 'alphabetic',\n  ideographic: 'ideographic',\n  hanging: 'hanging',\n};\n\nexport function updateTextElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedTextStyleProps,\n  text: Text,\n  runtime: GlobalRuntime,\n) {\n  // Trigger text geometry calculation.\n  text.getBounds();\n  const {\n    lineWidth = 1,\n    x = 0,\n    y = 0,\n    dx = 0,\n    dy = 0,\n    textPath,\n    textPathSide = 'left',\n    textPathStartOffset = 0,\n    textDecorationLine = '',\n    textDecorationColor = '',\n    textDecorationStyle = '',\n    metrics,\n  } = parsedStyle;\n  let { textBaseline = 'alphabetic' } = parsedStyle;\n\n  if (textBaseline === 'alphabetic') {\n    textBaseline = 'bottom';\n  }\n\n  $el.setAttribute('dominant-baseline', BASELINE_MAP[textBaseline]);\n\n  $el.setAttribute('paint-order', 'stroke');\n\n  const { lines, lineHeight, height } = metrics;\n\n  const lineNum = lines.length;\n\n  let styleCSSText = '';\n  if (dx !== 0 || dy !== 0) {\n    styleCSSText += `transform:translate(${dx}px, ${dy}px);`;\n  }\n  if (textDecorationLine && textDecorationLine !== 'none') {\n    // use CSS text-decoration since the implementation in SVG is not good enough\n    styleCSSText += `text-decoration:${textDecorationLine} ${textDecorationStyle} ${textDecorationColor};`;\n  }\n  if (styleCSSText) {\n    $el.setAttribute('style', styleCSSText);\n  }\n  if (x !== 0) {\n    $el.setAttribute('x', `${x}`);\n  }\n  if (y !== 0) {\n    $el.setAttribute('y', `${y}`);\n  }\n\n  if (lineNum === 1) {\n    const textContent = convertHTML(lines[0]);\n    $el.setAttribute('dx', `${lineWidth / 2}`);\n\n    // Since `text-after-edge` is not a standard property value, we use `dy` instead.\n    if (textBaseline === 'bottom' || textBaseline === 'top') {\n      $el.setAttribute('dominant-baseline', BASELINE_MAP.middle);\n      $el.setAttribute(\n        'dy',\n        textBaseline === 'bottom' ? `-${height / 2}px` : `${height / 2}px`,\n      );\n    }\n\n    // <textPath> only support one line\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/textPath\n    if (textPath) {\n      // clear existed text content first\n      $el.innerHTML = '';\n\n      // append <textPath href=\"#MyPath\">text</textPath>\n      const $textPath = createSVGElement('textPath', $el.ownerDocument);\n      $textPath.setAttribute('href', `#${TEXT_PATH_PREFIX + textPath.entity}`);\n      if (textPathSide !== 'left') {\n        $textPath.setAttribute('side', textPathSide);\n      }\n      if (textPathStartOffset !== 0) {\n        $textPath.setAttribute('startOffset', `${textPathStartOffset}`);\n      }\n      $textPath.innerHTML = textContent;\n      $el.appendChild($textPath);\n    } else {\n      $el.innerHTML = textContent;\n    }\n  } else {\n    $el.innerHTML = lines\n      .map((line: string, i: number) => {\n        const dx = lineWidth / 2;\n        let dy = 0;\n        if (i === 0) {\n          // TODO: handle other textBaseline values\n          if (textBaseline === 'middle') {\n            dy = lineHeight / 2 - height / 2;\n          } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n            dy = 0;\n          } else if (\n            textBaseline === 'bottom' ||\n            textBaseline === 'ideographic'\n          ) {\n            dy = -lineHeight * (lineNum - 1);\n          }\n        } else {\n          dy = lineHeight;\n        }\n        return `<tspan x=${x} dx=\"${dx}\" dy=\"${dy}\">${convertHTML(\n          line,\n        )}</tspan>`;\n      })\n      .join('');\n  }\n}\n","import type {\n  CanvasContext,\n  DisplayObject,\n  GlobalRuntime,\n  Text,\n} from '@antv/g-lite';\nimport { Shape } from '@antv/g-lite';\nimport {\n  updateImageElementAttribute,\n  updateLineElementAttribute,\n  updatePathElementAttribute,\n  updatePolylineElementAttribute,\n  updateRectElementAttribute,\n  updateTextElementAttribute,\n} from './shapes/paths';\nimport type { ElementLifeCycleContribution } from './interfaces';\nimport { createSVGElement } from './utils/dom';\n\nexport const SHAPE2TAGS: Record<Shape | string, string> = {\n  [Shape.RECT]: 'path',\n  [Shape.CIRCLE]: 'circle',\n  [Shape.ELLIPSE]: 'ellipse',\n  [Shape.IMAGE]: 'image',\n  [Shape.GROUP]: 'g',\n  [Shape.LINE]: 'line',\n  [Shape.POLYLINE]: 'polyline',\n  [Shape.POLYGON]: 'polygon',\n  [Shape.TEXT]: 'text',\n  [Shape.PATH]: 'path',\n  [Shape.HTML]: 'foreignObject',\n};\n\nexport const SHAPE_UPDATE_DEPS: Record<Shape | string, string[]> = {\n  [Shape.CIRCLE]: ['cx', 'cy', 'r'],\n  [Shape.ELLIPSE]: ['cx', 'cy', 'rx', 'ry'],\n  [Shape.RECT]: ['x', 'y', 'width', 'height', 'radius'],\n  [Shape.IMAGE]: ['x', 'y', 'src', 'width', 'height'],\n  [Shape.LINE]: [\n    'x1',\n    'y1',\n    'x2',\n    'y2',\n    'markerStart',\n    'markerEnd',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.POLYLINE]: [\n    'points',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.POLYGON]: [\n    'points',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.PATH]: [\n    'd',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.TEXT]: [\n    'text',\n    'font',\n    'fontSize',\n    'fontFamily',\n    'fontStyle',\n    'fontWeight',\n    'fontVariant',\n    'lineHeight',\n    'letterSpacing',\n    'wordWrap',\n    'wordWrapWidth',\n    'maxLines',\n    'leading',\n    'textBaseline',\n    'textAlign',\n    'textTransform',\n    'textOverflow',\n    'textPath',\n    'textPathSide',\n    'textPathStartOffset',\n    'textDecorationLine',\n    'textDecorationColor',\n    'textDecorationStyle',\n    // 'whiteSpace',\n    'dx',\n    'dy',\n  ],\n};\n\nexport class DefaultElementLifeCycleContribution\n  implements ElementLifeCycleContribution\n{\n  constructor(\n    private context: CanvasContext,\n    private runtime: GlobalRuntime,\n  ) {}\n\n  createElement(\n    object: DisplayObject,\n    svgElementMap: WeakMap<SVGElement, DisplayObject>,\n  ): SVGElement {\n    const { document: doc } = this.context.config;\n\n    const type = SHAPE2TAGS[object.nodeName] || 'g';\n    const $el = createSVGElement(type, doc || document);\n\n    svgElementMap.set($el, object);\n    return $el;\n  }\n\n  destroyElement(object: DisplayObject, $el: SVGElement) {}\n\n  shouldUpdateElementAttribute(object: DisplayObject, attributeName: string) {\n    const { nodeName } = object;\n    return (SHAPE_UPDATE_DEPS[nodeName] || []).indexOf(attributeName) > -1;\n  }\n\n  updateElementAttribute(object: DisplayObject) {\n    // @ts-ignore\n    const { $el } = object.elementSVG as ElementSVG;\n    const { nodeName, parsedStyle } = object;\n\n    switch (nodeName) {\n      case Shape.IMAGE: {\n        updateImageElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.RECT: {\n        updateRectElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.LINE: {\n        updateLineElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.POLYGON:\n      case Shape.POLYLINE: {\n        updatePolylineElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.PATH: {\n        updatePathElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.TEXT: {\n        updateTextElementAttribute(\n          $el,\n          parsedStyle,\n          object as Text,\n          this.runtime,\n        );\n        break;\n      }\n    }\n  }\n}\n","import { AbstractRendererPlugin, GlobalRuntime } from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { ElementSVG } from './components/ElementSVG';\nimport { DefaultElementLifeCycleContribution } from './DefaultElementLifeCycleContribution';\nimport { DefElementManager } from './shapes/defs';\nimport { SVGRendererPlugin } from './SVGRendererPlugin';\nimport type { SVGRendererPluginOptions } from './interfaces';\n\nexport * from './DefaultElementLifeCycleContribution';\nexport * from './shapes/paths';\nexport * from './SVGRendererPlugin';\nexport * from './interfaces';\nexport * from './utils/dom';\nexport { ElementSVG };\n\nexport class Plugin extends AbstractRendererPlugin {\n  name = 'svg-renderer';\n\n  constructor(private options: Partial<SVGRendererPluginOptions> = {}) {\n    super();\n  }\n\n  init(runtime: GlobalRuntime): void {\n    const { outputSVGElementId, outputSVGElementName } = this.options;\n    const defElementManager = new DefElementManager(this.context);\n\n    // default implementation\n    const defaultElementLifeCycleContribution =\n      new DefaultElementLifeCycleContribution(this.context, runtime);\n    // @ts-ignore\n    this.context.defaultElementLifeCycleContribution =\n      defaultElementLifeCycleContribution;\n\n    // @ts-ignore\n    this.context.SVGElementLifeCycleContribution =\n      defaultElementLifeCycleContribution;\n\n    const SVGRendererPluginOptions: SVGRendererPluginOptions = {\n      outputSVGElementId: !isNil(outputSVGElementId)\n        ? !!outputSVGElementId\n        : true,\n      outputSVGElementName: !isNil(outputSVGElementName)\n        ? !!outputSVGElementName\n        : true,\n    };\n\n    this.addRenderingPlugin(\n      // @ts-ignore\n      new SVGRendererPlugin(\n        SVGRendererPluginOptions,\n        defElementManager,\n        this.context,\n      ),\n    );\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n\n    // @ts-ignore\n    delete this.context.defaultElementLifeCycleContribution;\n    // @ts-ignore\n    delete this.context.SVGElementLifeCycleContribution;\n  }\n}\n"],"names":["ElementSVG","_createClass","_classCallCheck","tag","updateImageElementAttribute","$el","parsedStyle","_parsedStyle$src","src","_parsedStyle$x","x","_parsedStyle$y","y","width","height","setAttribute","concat","isString","Image","HTMLElement","nodeName","toUpperCase","toDataURL","ImageData","canvas","document","createElement","context","getContext","putImageData","updateLineElementAttribute","x1","y1","x2","y2","markerStart","markerEnd","markerStartOffset","markerEndOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","rad","isDisplayObject","Math","atan2","cos","sin","updatePathElementAttribute","d","_getStartTangent","parentNode","getStartTangent","_getStartTangent2","_slicedToArray","p1","p2","_getEndTangent","getEndTangent","_getEndTangent2","translatePathToString","absolutePath","updatePolylineElementAttribute","points","length","map","point","i","offsetX","offsetY","join","updateRectElementAttribute","radius","isFinite","hasRadius","some","r","_radius$map","clamp","min","abs","_radius$map2","tlr","trr","brr","blr","signX","signY","sweepFlag","createSVGElement","type","doc","createElementNS","FILTER_PREFIX","createOrUpdateFilter","$def","object","filters","filterName","entity","$existedFilters","querySelectorAll","forEach","$filter","removeChild","removeAttribute","filterIds","_ref","name","params","createBlur","createBrightness","createDropShadow","createContrast","createGrayscale","createSepia","createSaturate","createHueRotate","createInvert","id","appendChild","setTimeout","filterId","convertToAbsoluteValue","param","unit","UnitType","kPercentage","value","$feGaussianBlur","createFeComponentTransfer","_ref2","slope","intercept","tableValues","$feComponentTransfer","$feFunc","amount","$feColorMatrix","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","formatted","$feOffset","$feFlood","$feComposite","$feMerge","$feMergeNode1","$feMergeNode2","createFeColorMatrix","matrix","PATTERN_PREFIX","cacheKey2IDMap","counter","resetPatternCounter","createOrUpdateGradientAndPattern","parsedColor","createImage","plugin","isCSSRGB","style","isNone","toString","isPattern","patternId","createOrUpdatePattern","gradientId","createOrUpdateGradient","createOrUpdateMultiGradient","generateCacheKey","options","arguments","undefined","cacheKey","isCSSGradientValue","GradientType","LinearGradient","RadialGradient","_value$options","_objectSpread","steps","angle","cx","cy","size","offset","color","image","repetition","formatTransform","transform","parseTransform","parsed","t","newScale","s","newSkew","_d$map","_d$map2","a","b","c","dd","tx","ty","filter","item","create$Pattern","pattern","$pattern","_object$getGeometryBo","getGeometryBounds","halfExtents","patternWidth","patternHeight","$existed","querySelector","imageURL","isBrowser","HTMLImageElement","HTMLCanvasElement","$image","img","window","match","crossOrigin","onload","complete","_parsedStyle","createSVGDom","svgElement","elementSVG","localTransform","getLocalTransform","applyTransform","$groupEl","bounds","innerHTML","sort","_ref3","_computeLinearGradien","computeLinearGradient","_ref4","_computeRadialGradien","computeRadialGradient","gradients","blended","gradient","rectId","$rect","$feImage","$feBlend","FILTER_DROPSHADOW_PREFIX","createOrUpdateShadow","_object$parsedStyle","_object$parsedStyle$s","shadowType","hasShadow","isNil","shadowId","$existedFilter","existedShadowType","getAttribute","remove","$feDropShadow","$feFuncA","$feComposite2","$feMergeNode","children","urlRegexp","DefElementManager","gradientCache","key","getDefElement","init","config","$svg","contextService","clear","_this","Object","keys","clearUnusedDefElement","cache","has","targetElement","_this$context$config","attributeValue","matches","replace","newDefElementId","Set","add","numberToLongString","toFixed","convertHTML","str","regex","SVG_ATTR_MAP","opacity","fillStyle","fill","fillRule","fillOpacity","strokeStyle","strokeOpacity","stroke","clipPath","textPath","rx","ry","lineCap","lineJoin","lineWidth","lineDash","lineDashOffset","miterLimit","font","fontSize","fontStyle","fontVariant","fontWeight","fontFamily","letterSpacing","startArrow","endArrow","preserveAspectRatio","visibility","textAlign","pointerEvents","FORMAT_VALUE_MAP","inherit","left","start","center","right","end","DEFAULT_VALUE_MAP","strokeWidth","strokeMiterLimit","G_SVG_PREFIX","CLIP_PATH_PREFIX","TEXT_PATH_PREFIX","SVGRendererPlugin","pluginOptions","defElementManager","svgElementMap","WeakMap","renderQueue","dirtyAttributes","pendingReorderQueue","clipPathUseMap","apply","renderingService","renderingContext","root","ownerDocument","defaultView","handleMounted","e","target","$useRefs","get","existed","getId","$camera","handleUnmounted","removeSVGDom","reorderChildren","_object$parentNode","parent","slice","handleReparent","handleAttributeChanged","attrName","attribtues","set","push","handleGeometryBoundsChanged","nodes","Shape","FRAGMENT","childNodes","_object$elementSVG","parentInvert","mat4","invert","create","getWorldTransform","clipPathId","hooks","tap","background","camera","getOrthoMatrix","addEventListener","ElementEvent","MOUNTED","UNMOUNTED","REPARENT","ATTR_MODIFIED","BOUNDS_CHANGED","destroy","removeEventListener","render","beginFrame","_object$elementSVG2","$parentGroupEl","endFrame","renderReasons","RenderReason","CAMERA_CHANGED","_elementSVG","_elementSVG2","$use","renderable","dirty","attributes","createOrUpdateHitArea","updateAttribute","sortable","renderOrder","fragment","createDocumentFragment","child","isConnected","rts","applyAttributes","HTML","IMAGE","_this2","$hitTestingEl","shouldUpdateElementAttribute","SVGElementLifeCycleContribution","updateElementAttribute","_FORMAT_VALUE_MAP$nam","_propertyMetadataCach","usedName","computedValue","computedValueStr","formattedValueStr","usedValue","inherited","propertyMetadataCache","inh","createOrUpdateInnerHTML","GROUP","isCustomElement","createOrUpdateClipOrTextPath","noWrapWithGroup","_object$parentNode$el","outputSVGElementId","outputSVGElementName","hasAttribute","_object$elementSVG3","destroyElement","increasedLineWidthForHitTesting","Number","cloneNode","attribute","hasFill","$div","isTextPath","PREFIX","attributeNameCamel","attributeNameHyphen","$clipPath","$existedClipPath","BASELINE_MAP","top","middle","bottom","alphabetic","ideographic","hanging","updateTextElementAttribute","text","runtime","getBounds","_parsedStyle$lineWidt","_parsedStyle$dx","dx","_parsedStyle$dy","dy","_parsedStyle$textPath","textPathSide","_parsedStyle$textPath2","textPathStartOffset","_parsedStyle$textDeco","textDecorationLine","_parsedStyle$textDeco2","textDecorationColor","_parsedStyle$textDeco3","textDecorationStyle","metrics","_parsedStyle$textBase","textBaseline","lines","lineHeight","lineNum","styleCSSText","textContent","$textPath","line","SHAPE2TAGS","_SHAPE2TAGS","_defineProperty","RECT","CIRCLE","ELLIPSE","LINE","POLYLINE","POLYGON","TEXT","PATH","SHAPE_UPDATE_DEPS","DefaultElementLifeCycleContribution","attributeName","indexOf","Plugin","_AbstractRendererPlug","_callSuper","_inherits","_this$options","defaultElementLifeCycleContribution","SVGRendererPluginOptions","addRenderingPlugin","removeAllRenderingPlugins","AbstractRendererPlugin"],"mappings":"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"}